# ROS作用域总结

## 配置文件中的参数作用域

今天在写节点时希望从ros的参数服务器中读取全局参数以达到更改参数但不用重新编译的好处，但是遇到了一些问题无法读取，主要是代码中的参数与配置文件的参数作用域不一致的问题，现总结如下：

首先，参数服务器是有作用域的，即每个yaml文件都可以进行作用域的嵌套，比如

![](/home/wu/图片/2021-08-04 19-46-10 的屏幕截图.png)

`controller_params.yaml`下的所有参数都在`controller`作用域下，又因为该配置文件是在`move_base`这个节点下加载的:

![](/home/wu/图片/2021-08-04 19-50-38 的屏幕截图.png)

因此前面还要加上`/move_base`作为前缀,所以该配置文件的参数作用域即为：`/move_base/controller`

如果这里配置文件加载时后面还声明了作用域:`ns="controller"`

![](/home/wu/图片/2021-08-04 19-50-19 的屏幕截图.png)

那么该配置文件中所有参数的作用域即为：`/move_base/controller/controller`，显然我们不希望有两个相同的作用域，因此这里ns无需设置，只要在配置文件中声明即可！

这里配置文件的参数作用域即决定了参数服务器中参数的作用域，因此这里的改变可以通过`rosparam list`直观看到。

<img src="/home/wu/图片/2021-08-04 19-58-35 的屏幕截图.png" style="zoom:67%;" />

## 程序中的参数作用域

配置好参数文件中的作用域，下一步就是要通过程序与该作用域对应上，如果作用域不一致，那么程序无法读取参数文件中的参数！

程序中的参数作用域由节点句柄`ros::NodeHandle`决定，由于配置文件的参数作用域为`/move_base/controller`

为了与之匹配，需将节点句柄的作用域声明为：

<img src="/home/wu/图片/2021-08-04 20-00-57 的屏幕截图.png" style="zoom: 67%;" />

这样节点句柄的作用域与配置文件参数作用域对应上了，就可以通过程序读取配置文件中的参数值了！

![](/home/wu/图片/2021-08-04 20-02-34 的屏幕截图.png)